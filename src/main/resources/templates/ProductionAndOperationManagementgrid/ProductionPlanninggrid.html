<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Production Planning</title>
    
    <link rel="stylesheet" href="/css/hrms.css"> <!-- // for side bar code  -->
    <link rel="stylesheet" href="/css/grid.css">
    <link rel="stylesheet" href="/css/emplist.css">

    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&display=swap" rel="stylesheet">
</head>
<!-- ✅ Internal CSS for Button Styling -->
  <style>
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #f0f0f0;
      padding: 10px 20px;
    }

    .search-box {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .search-box button,
    .back-button {
      padding: 6px 12px;
      font-size: 14px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    .search-box button:hover,
    .back-button:hover {
      background-color: #0056b3;
    }
  </style>
<body>
<div th:replace="~{PRODUCTIONANDOPERATION.html :: sidebarFragment}"></div> <!-- // for side bar code  -->

<div class="button-container">
    
</div>

<div class="button-grid">
    <button onclick="loadProductionPlanningTable()"style="width:112%">Production Planning Form</button>
</div>

<div id="productionplanning-table-container">
   
</div> <!-- Table will be dynamically loaded here -->

<script src="/js/grid.js"></script>
<script> function goBack() {
	window.location.href = '/dashboard';
	  }</script>

<script>
    function loadProductionPlanningTable() {
        // Create the button and table container structure immediately
        const container = document.getElementById("productionplanning-table-container");
        container.innerHTML =`
            <div class="table-header">
				<div class="button-container" style="margin-left: 1045px;">
				                <button class="styled-button" onclick="window.location.href='/productionandoperationmanagement/productionplanninggrid'" style="flex-grow: 1;">
				                    <i class="fas fa-arrow-left"></i> Back
				                </button>
				                <button id="open-register-btn" class="styled-button" style="flex-grow: 1; margin-left: 20px;">
				                    Production Planning Form
				                </button>
				            </div>
				</div>
            <table>
                <thead>
                    <tr>
                        
                        <th>Product Planning ID</th>
                        <th>Product ID</th>
        				<th>Product Name</th>
                        <th>Production Type</th>
                        <th>Start Date</th>
                        <th>End Date</th>
                        <th>Raw Materials Details</th>
                        <th>Cost Estimation</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="productionplanningmanagement-table-body">
                    <tr><td colspan="9">Loading data...</td></tr>
                </tbody>
            </table>
        `;

        // Add event listener to the "Register Employee" button
        document.getElementById("open-register-btn").addEventListener("click", () => {
            // Redirect to the employeeattendance registration form
            window.location.href = '/productionplanningform';
        });

        // Fetch and populate table data
        fetch('/viewproductionplanninglist')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            
            .then(data => {
                const headers = data.headers; // Extract headers dynamically
                const rows = data.data;      // Extract employee data
                const tbody = document.getElementById("productionplanningmanagement-table-body");

                // Check if there are rows to display
                if (rows.length === 0) {
                    tbody.innerHTML = `<tr><td colspan="9">No data available.</td></tr>`;
                    return;
                }

                // Generate rows from data
                tbody.innerHTML = rows.map(row => `
                    <tr>
                      
                        <td>${row['Production Planning ID']}</td>
                        <td>${row['Product ID']}</td>
                        <td>${row['Product Name']}</td>
                        <td>${row['Production Type']}</td>
                        <td>${row['Start Date']}</td>
                        <td>${row['End Date']}</td>
                        <td>${row['Raw Materials Details']}</td>
                        <td>${row['Cost Estimation']}</td>
                       <td>
                       <div class="action-buttons">
                     
                       <a href="/deleteproductionplanninginfo?productionplanninguid=${row['Production Planning ID']}"
                    	   class="btn btn-delete"
                    	   onclick="return confirmDeleteProductionPlanning(this);"
                    	   ${row['Production Planning ID'] ? '' : 'style="display:none;"'}>
                    	   Delete
                    	</a>

                       <!-- Update button (modified URL using mode=update) -->
                       <a href="/productionplanning?mode=update&uid=${row['Production Planning ID']}"
                          class="btn btn-update"
                          ${row['Production Planning ID'] ? '' : 'style="display:none;"'}>
                           Update
                       </a>
                   </td
                   

                   </div>
               </td>
                    </tr>
                `).join('');
            })
            .catch(error => {
                console.error('Error fetching Production Planning data:', error);
                document.getElementById("productionplanningmanagement-table-body").innerHTML = `<tr><td colspan="9">Error loading data.</td></tr>`;
            });
    }

    // Example function to handle delete action
		function confirmDeleteProductionPlanning(element) {
  		  const url = element.getAttribute('href');
   		 const productionplanninguid = new URLSearchParams(url.split('?')[1]).get('productionplanninguid');

  		  if (confirm(`Are you sure you want to delete Production Planning with ID: ${productionplanninguid}?`)) {
        return true; // Allow redirect to deletion controller
    }
    return false; // Cancel the action
}


	
	
</script>




</body>
</html>
